import io.jsonwebtoken.Jwts;\nimport io.jsonwebtoken.SignatureAlgorithm;\nimport io.jsonwebtoken.Claims;\nimport java.util.Date;\n\npublic class JwtUtil {\n    private static final String SECRET_KEY = \"your-secret-key-change-in-production\";\n    private static final long EXPIRATION_TIME = 86400000; // 24 hours\n\n    public static String generateToken(User user) {\n        return Jwts.builder()\n                .setSubject(user.getEmail())\n                .claim(\"userId\", user.getId())\n                .claim(\"name\", user.getName())\n                .claim(\"role\", user.getRole())\n                .setIssuedAt(new Date())\n                .setExpiration(new Date(System.currentTimeMillis() + EXPIRATION_TIME))\n                .signWith(SignatureAlgorithm.HS512, SECRET_KEY)\n                .compact();\n    }\n\n    public static Claims getClaims(String token) {\n        try {\n            return Jwts.parser().setSigningKey(SECRET_KEY).parseClaimsJws(token).getBody();\n        } catch (Exception e) {\n            return null;\n        }\n    }\n\n    public static User getUserFromToken(String tokenHeader, UserRepository userRepo) {\n        if(tokenHeader == null || !tokenHeader.startsWith(\"Bearer \")) return null;\n        \n        String token = tokenHeader.substring(7);\n        Claims claims = getClaims(token);\n        \n        if(claims == null) return null;\n        return userRepo.findByEmail(claims.getSubject()).orElse(null);\n    }\n\n    public static boolean isTokenValid(String token) {\n        Claims claims = getClaims(token);\n        return claims != null && claims.getExpiration().after(new Date());\n    }\n}\n