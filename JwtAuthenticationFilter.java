import org.springframework.web.filter.OncePerRequestFilter;\nimport javax.servlet.FilterChain;\nimport javax.servlet.ServletException;\nimport javax.servlet.http.HttpServletRequest;\nimport javax.servlet.http.HttpServletResponse;\nimport java.io.IOException;\n\npublic class JwtAuthenticationFilter extends OncePerRequestFilter {\n    @Override\n    protected void doFilterInternal(HttpServletRequest request, \n                                   HttpServletResponse response, \n                                   FilterChain filterChain) throws ServletException, IOException {\n        try {\n            String authHeader = request.getHeader(\"Authorization\");\n            \n            if(authHeader != null && authHeader.startsWith(\"Bearer \")) {\n                String token = authHeader.substring(7);\n                \n                if(JwtUtil.isTokenValid(token)) {\n                    filterChain.doFilter(request, response);\n                    return;\n                }\n            }\n            \n            // Allow requests to /auth/** without token\n            if(request.getRequestURI().startsWith(\"/auth/\")) {\n                filterChain.doFilter(request, response);\n                return;\n            }\n            \n            response.sendError(HttpServletResponse.SC_UNAUTHORIZED, \"Invalid or missing token\");\n        } catch (Exception e) {\n            response.sendError(HttpServletResponse.SC_UNAUTHORIZED, \"Token validation failed\");\n        }\n    }\n}\n